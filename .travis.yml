language: node_js
node_js:
- stable
install:
- npm install
cache:
  directories:
  - node_modules
env:
  global:
  - NODE_ENV=test
services:
- postgresql
deploy:
  provider: heroku
  api_key:
    secure: lpotBmr3RkI/C6BqHzU1JLW3qxQIIV8TdgoRZquwrSRDL/Oj05K4zdTm9Mps/6jIH5P9hRRJSmk1lUMSlMh8Vv5YCHFQfEYAJYq80tJXeyEG6YfPTxFCNuwGK7PCWWwyvIov9f/L+X6gZDyMDStwLL+ZDyJDte8X3a3aqlxXYQoe/7uQ/0PPYF8Do4vR5rKc9FrFVfX25QzRnWMcseEuEstXnK6/69MSmEA74LPtA7HBVXrwyg7BOQAznz3edDK4TE71+/hvmXeW/TgjuTXGoHcFIBQyxGl8EqHVpbz2kbDFaQoJ3a6m9vA/IZRhk5R+8U/s4cEHxgxJPjo4xsayMFvA+0LU917kxHzwGOo7tTybIoVoIjWMlkpEzYzUkNCkdHLCGqNm/LKUFNHEy0k2Ph1ZBKhkjaNPyJ5Doa5pGD3CjGApjXNCB8rKKklLcrRBtNNO2GCbX+A9LJ8c6TjGW/k192PR8XfTyfTvM/SLAmVc89v4o4jH73lAz3n68h0Nk4OUkZA59WShwe5PgfCr3SykxdjPUBMujCGvvU24mwWiDvpDzv1R5X/LL3z7yjfdHXPvKn66W0sYWDUy8ap3eERXkKMoS8+LFUFcVE+JsG8jFh8a+gJAloTQXPHnG9ORmwHMzmv8yiADjud4lt1UQXNnk0dgMjiP+z9q6ZahkFE=
  app: wayfarerapi-andela
  on:
    repo: Ucheduk/WayFarer-API
    branch: develop
before_script:
- psql -c 'create database wayfarer_test_db;' -U postgres
- psql -c "ALTER USER postgres PASSWORD 'password'";
- sh ./setup-test-db.sh
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- npm run test:coverage
after_script:
- "./cc-test-reporter -p ./coverage/lcov.info after-build --exit-code $TRAVIS_TEST_RESULT"
notifications:
- email: flase
